{% extends 'recommendations/base.html' %}

{% block title %}Home - SmartShop{% endblock %}

{% block content %}
<div style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; padding: 50px 30px; border-radius: 12px; margin: 30px 0; text-align: center;">
    <h1 style="font-size: 2.5em; margin-bottom: 15px;">Welcome to SmartShop! ğŸ‰</h1>
    <p style="font-size: 1.2em; opacity: 0.95;">Discover products tailored just for you with AI-powered recommendations</p>
</div>

{% if user.is_authenticated %}
<div class="alert alert-info">
    <strong>ğŸ‘‹ Hi {{ user.username }}!</strong> Check out our <a href="{% url 'my_recommendations' %}" style="color: #0056b3; font-weight: bold;">personalized recommendations</a> based on your interests!
</div>
{% else %}
<div class="alert alert-info">
    <strong>ğŸ” Please <a href="/accounts/login/" style="color: #0056b3; font-weight: bold;">login</a></strong> to get personalized product recommendations!<br>
    <small>Test credentials: Username: user1, Password: password123</small>
</div>
{% endif %}

<h2 class="section-title">âœ¨ Featured Products</h2>

<div class="product-grid">
    {% for product in products %}
    <div class="product-card">

        <!-- ğŸ”¥ PRODUCT IMAGE ADDED HERE -->
        {% if product.image %}
            <img src="{{ product.image.url }}" 
                 alt="{{ product.name }}"
                 style="width:100%; height:250px; object-fit:cover; border-radius:8px;">
        {% endif %}
        <!-- END IMAGE -->

        <h3>{{ product.name }}</h3>
        <span class="category">{{ product.category.name }}</span>
        <p>{{ product.description|truncatewords:15 }}</p>

        <div class="rating">
            {% if product.average_rating > 0 %}
                â­ {{ product.average_rating|floatformat:1 }}
            {% else %}
                â­ New Product
            {% endif %}
        </div>

        <div class="price">${{ product.price }}</div>
        <a href="{% url 'product_detail' product.id %}" class="btn">View Details â†’</a>
    </div>
    {% empty %}
    <div style="grid-column: 1/-1; text-align: center; padding: 50px;">
        <h3>No products available</h3>
        <p>Please run: <code>python populate_db.py</code></p>
    </div>
    {% endfor %}
</div>

{% if categories %}
<h2 class="section-title">ğŸ·ï¸ Shop by Category</h2>

<div style="display: flex; gap: 15px; flex-wrap: wrap; margin: 20px 0;">
    {% for category in categories %}
    
    <a href="{% url 'category_products' category.id %}" 
       style="text-decoration: none;">

        <div style="
            background: white; 
            padding: 20px 30px; 
            border-radius: 8px; 
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
            transition: 0.3s;
            cursor: pointer;
            width: 200px;
            height: 200px;
        ">
            <h3 style="color: #2c3e50; margin-bottom: 5px;">{{ category.name }}</h3>
            <p style="color: #666; font-size: 0.9em;">{{ category.description }}</p>
        </div>

    </a>

    {% endfor %}
</div>
{% endif %}

{% endblock %}
